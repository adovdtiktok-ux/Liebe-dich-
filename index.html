<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Люблю тебя</title>
<style>
body{margin:0;overflow:hidden;background:black;font-family:monospace;}
#code{color:#00ffcc;white-space:pre;font-size:14px;padding:20px;height:100vh;overflow:hidden;}
#scene{display:none;width:100%;height:100vh;perspective:1000px;}
#text{position:absolute;top:5%;width:100%;text-align:center;font-size:28px;font-weight:bold;color:#ff3399;opacity:0;}
</style>
</head>
<body>
<div id="code"></div>
<div id="scene"></div>
<div id="text">Люблю тебя, моя принцесса</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>
<script>
// ===== Быстро пролистывающийся код =====
const codeEl = document.getElementById('code');
let codeLines=[];
for(let i=0;i<600;i++){codeLines.push(`System.out.println("love ❤️ ${i}")`);}
codeEl.textContent = codeLines.join("\n");

// ===== Переход к сцене =====
setTimeout(()=>{
  codeEl.style.display="none";
  document.getElementById('scene').style.display="block";
  initHeartScene();
  fadeInText();
},4000);

// ===== Текст =====
function fadeInText(){
  const txt = document.getElementById('text');
  let op=0;
  const interval=setInterval(()=>{
    op+=0.02;
    txt.style.opacity=op;
    if(op>=1) clearInterval(interval);
  },50);
}

// ===== Three.js сердце =====
function initHeartScene(){
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
  camera.position.z=50;

  const renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth,window.innerHeight);
  document.getElementById('scene').appendChild(renderer.domElement);

  // ===== Частицы сердца =====
  const particleCount = 10000;
  const geometry = new THREE.BufferGeometry();
  const positions = [];
  const sizes = [];

  for(let i=0;i<particleCount;i++){
    let t = Math.random()*Math.PI*2;
    let s = Math.random();
    let x = 16*Math.pow(Math.sin(t),3);
    let y = -(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));
    let z = (Math.random()-0.5)*8;
    positions.push(x*1.5+s*0.5,y*1.5+s*0.5,z);
    sizes.push(0.5 + Math.random()*0.5);
  }

  geometry.setAttribute('position',new THREE.Float32BufferAttribute(positions,3));
  geometry.setAttribute('size',new THREE.Float32BufferAttribute(sizes,1));

  const material = new THREE.PointsMaterial({color:0xff0000,size:0.5,sizeAttenuation:true});
  const heart = new THREE.Points(geometry,material);
  scene.add(heart);

  // ===== Анимация =====
  const clock = new THREE.Clock();
  function animate(){
    requestAnimationFrame(animate);
    let time=clock.getElapsedTime();

    // Пульсация
    let scale = 1 + 0.15*Math.sin(time*2);
    heart.scale.set(scale,scale,scale);

    // Закручивание внутрь/наружу
    heart.rotation.y = time*0.4;
    heart.rotation.x = Math.sin(time*0.5)*0.3;

    // Маленькие движения частиц
    const pos = geometry.attributes.position.array;
    for(let i=0;i<pos.length;i+=3){
      pos[i+2] += 0.01*Math.sin(time+i);
    }
    geometry.attributes.position.needsUpdate = true;

    renderer.render(scene,camera);
  }
  animate();

  window.addEventListener('resize',()=>{
    camera.aspect=window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth,window.innerHeight);
  });
}
</script>
</body>
</html>
